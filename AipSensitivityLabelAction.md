## AipSensitivityLabelAction

Azure Information Protection (AIP) sensitivity label events are actions or activities that are triggered when a sensitivity label is applied to a document or email. These events are defined by the organization using AIP, and can be used to automate various tasks or processes based on the sensitivity labels applied to sensitive data. For example, an organization might set up an event that automatically encrypts a document if it's labeled as "confidential," or that sends a notification to the data owner if a document is labeled as "internal" and shared outside the organization. These events can help organizations ensure that their sensitive data is protected and used in compliance with their security policies.

# Establishing remote Powershell session

This will establish a remote PowerShell session with Exchange Online.Once the connection is established, you can run Exchange Online cmdlets to manage your Exchange Online environment. 

Open a PowerShell window and run the Install-Module -Name ExchangeOnlineManagement command to install the Exchange Online Management module. This module provides cmdlets that can be used to manage Exchange Online.

1. Connect-IPPSSession is a PowerShell cmdlet used to create a remote connection to an Exchange Online PowerShell session.
2. Import-Module ExchangeOnlineManagement is a PowerShell cmdlet used to import the Exchange Online Management module into the current PowerShell session.

```powershell
# Import the PSSSession and Exchange Online cmdlets
Connect-IPPSSession
Import-Module ExchangeOnlineManagement
```

## Option 1 :- If you want to connect with a specific user. 

Command to prompt for a specific user for  your Exchange Online credentials.
```powershell
$UserCredential = Get-Credential 
```
Command to connect to Exchange Online using the provided credentials. 
```powershell
 Connect-ExchangeOnline -Credential $UserCredential -ShowProgress $true 
```
## Option 2 :- If you want to connect with credentials in the current session
Connect to Exchange Online using the credentials in the current session
```powershell
Connect-ExchangeOnline
```

# Extracting AipSensitivityLabelAction

```powershell
Search-UnifiedAuditLog -RecordType 'AipSensitivityLabelAction'  -StartDate "12/1/2022" -EndDate "12/31/2022" -ResultSize 1000
```
# Attributes of the AipSensitivityLabelAction event
The following table contains information related to AIP sensitivity label events.

| Event                 | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| :-------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| PSComputerName        | Computer Name                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| RunspaceId            | The Runspace is a specific instance of PowerShell which contains modifiable collections of commands, providers, variables, functions, and language elements that are available to the command line user.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| PSShowComputerName    | The value is False for documented edited in Office 365.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| RecordType            | Shows the value of Label Action. The operation type indicated by the record. For more information, see the [full list of record types](/office/office-365-management-api/office-365-management-activity-api-schema#auditlogrecordtype).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| CreationDate          | The date and time in Coordinated Universal Time (UTC) in ISO8601 format when the user performed the activity.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| UserId                | The User Principal Name (UPN) of the user who performed the action (specified in the Operation property) that resulted in the record being logged; for example, my_name@my_domain_name. <br><br>Note that records for activity performed by system accounts (such as SHAREPOINT\system or NT AUTHORITY\SYSTEM) are also included. In SharePoint, another value display in the UserId property is app@sharepoint. This indicates that the "user" who performed the activity was an application that has the necessary permissions in SharePoint to perform organization-wide actions (such as search a SharePoint site or OneDrive account) on behalf of a user, admin, or service. For more information, see the [app@sharepoint user in audit records](/microsoft-365/compliance/search-the-audit-log-in-security-and-compliance?view=o365-worldwide#the-appsharepoint-user-in-audit-records). |
| Operation             | The operation type for the audit log.The name of the user or admin activity. For a description of the most common operations/activities:</br>SensitivityLabelApplied</br>SensitivityLabelUpdated</br>SensitivityLabelRemoved</br>SensitivityLabelPolicyMatched</br>SensitivityLabeledFileOpened.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Identity              | The identity of the user or service to be authenticated.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| IsValid               | Boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ObjectState           | Specifies the state of the object.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| SensitiveInfoTypeData | Stores the datatype of the Sensitive Info Type Data                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProtectionType        | Protection type can be template or ad-hoc.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| TemplateId            | TemplateID parameter to get a specific template. The Get-AipServiceTemplate cmdlet gets all existing or selected protection templates from Azure Information Protection.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| IsProtected           | Whether protected: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| IsProtectedBefore     | Whether the content was protected before change: True/False                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ApplicationId         | Corresponds to the Azure AD Application ID.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ApplicationName       | Application friendly name of the application performing the operation.</br>Outlook (for email), OWA (for email), Word (for file), Excel (for file), PowerPoint (for file).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| ProcessName           | Process that hosts MIP SDK.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Platform              | Device platform (Win, OSX, Android, iOS).â€¯                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| DeviceName            | The name of the user's device.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Location              | The location of the document with respect to the user's device. The possible values are unknown, localMedia, removableMedia, fileshare, and cloud.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ProductVersion        | Version of the Azure Information Protection client that performed the audit action.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| DataState             | Specifies the state of the data.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
